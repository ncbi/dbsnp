# This file is read/parsed by test_grafpop.pl
# It includes the following pipe (|) delimited columns:

# Test Name | Executable | Input File | Race File | Options | Output File | IFile Expected | Output Msg

# Test Name:     Name of the test case
# Executable:    Name of the executable being tested
# Input File:    The name of the input file required by the program
# Race File:     The name of the self-report subject race file
# Options:       Other optional parameter settings
# Output File:   Output file generated by the program
# File expected: If the output file is expected to be generated (Y = Yes)
# Output Msg:    Expected key string included in STDOUT output message

############### The following test cases test C++ program grafpop

# grafpop with a good PLINK set
GrafPop with PLINK | grafpop | TG_50_2000.bed | | | TG_50_2000_pops.txt | Y | Saved population results

# grafpop with PLINK basename
GrafPop with PLINK basename | grafpop | TG_50_2000 | | | TG_50_2000_pops_base.txt | Y | Saved population results

# grafpop with a vcf file
GrafPop with VCF | grafpop | TG_26_500.vcf | | | TG_26_500_pops.txt | Y | Saved population results

# grafpop with a vcf.gz file
GrafPop with VCF.gz | grafpop | TG_26_500_zip.vcf.gz | | | TG_26_500_pops.txt | Y | Saved population results

# grafpop with a vcf file but actual vcf.gz
GrafPop with VCF wrong extension | grafpop | TG_26_500_gz.vcf | | | TG_26_500_pops_gzvcf.txt | Y | Saved population results

# grafpop with GB37 chr pop in bim
GrafPop with GB37 | grafpop | TG_10_1000_g37.bed | | | TG_10_1000_g37_pops.txt | Y | GRCh 37 chromosome positions are used 

# grafpop with GB38 chr pop in bim
GrafPop with GB38 | grafpop | TG_10_1000_g38.bed | | | TG_10_1000_g38_pops.txt | Y | GRCh 38 chromosome positions are used 

# grafpop with PLINK of not enough ancestry SNPs
Not enough ancestry SNPs | grafpop | TG_50_20.bed | | | TG_50_2000_pops.txt | | Ancestry inference not done

# grafpop with PLINK of not enough genotyped SNPs
Not enough genotyped SNPs | grafpop | TG_10_120_invalid.bed | | | TG_10_120_pops.txt | | NOTE: None of

# grafpop with PLINK of wrong number of samples
Wrong fam file | grafpop | TG_wrong_smps.bed | | | TG_wrong_smps.txt | | ERROR: Number of genotypes in bed

# grafpop with PLINK of wrong number of SNPs
Wrong bim file | grafpop | TG_wrong_snps.bed | | | TG_wrong_snps.txt | | ERROR: Number of genotypes in bed

# grafpop with PLINK of missing fam
Missing fam file | grafpop | TG_10_1000_nofam.bed | | | TG_10_1000_nofam.txt | | ERROR: didn't find

# grafpop with PLINK of missing bim
Missing bim file | grafpop | TG_10_1000_nobim.bed | | | TG_10_1000_nobim.txt | | ERROR: didn't find

# grafpop with incorrect file name
Incorrect file name | grafpop | TG_wrong_name.bed | | | TG_wrong_name.txt | | ERROR: Genotype file

# grafpop with invalid vcf file
Invalid VCF | grafpop | TG_invalid.vcf | | | TG_invalid.txt | | ERROR: didn't find #CHROM row

# grafpop with empty vcf
Empty VCF | grafpop | TG_empty.vcf | | | TG_empty_vcf.txt | | ERROR: doesn't include samples

# grafpop with no valid SNP vcf
No ancestry SNP VCF | grafpop | TG_2_invalid_snp_chr23.vcf | | | TG_no_anc_snp_vcf.txt | | WARNING: Ancestry inference not done due to lack of genotyped

# grafpop with wrong sample vcf
Wrong sample VCF | grafpop | TG_wrong_smps.vcf | | | TG_wrong_smps_vcf.txt | | ERROR is different from #samples


############### The following test cases test Perl script PlotGrafPopResults.pl

# Plot results with default settings
Plot with default parameters | PlotGrafPopResults.pl | TG_50_2000_pops.txt | | | TG_50_2000_pops.png | Y | Graph saved to

# Plot results with subject races
Plot with subject races | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | | TG_50_2000_pops_race.png | Y | Graph saved to

# Plot results with subject races, dot size 5
Plot with dot 5 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 | TG_50_2000_pops_dot5.png | Y | Graph saved to

# Plot results with subject races, dot size 5, expcted areas
Plot with areas | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -areas 1,2,3,4,5,6,7,8 | TG_50_2000_pops_area1_8.png | Y | Graph saved to

# Plot results with subject races, cutoff line
Plot with cutoff lines | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -cutoff | TG_50_2000_pops_cutoff.png | Y | Graph saved to

# Plot results with subject races, dot size 5, gd4
Plot with GD4 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -gd4 | TG_50_2000_pops_gd4.png | Y | Graph saved to

# Plot results with subject races, dot size 5, gd4, cutoff
Plot with GD4 + cutoff | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -gd4 -cutoff | TG_50_2000_pops_gd4_cut.png | Y | Graph saved to

# Plot results with subject races, rotate 90 degree
Plot with rotate 90 degree | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -rotx 90 | TG_50_2000_pops_rot90.png | Y | Graph saved to

# Plot results with subject races, rotate 135 degree
Plot with rotate 135 degree | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -rotx 135 | TG_50_2000_pops_rot135.png | Y | Graph saved to

# Plot results with subject races, rotate 265 degree
Plot with rotate 265 degree | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -rotx 265 | TG_50_2000_pops_rot265.png | Y | Graph saved to

# Plot results with subject races, rotate 400 degree
Plot with rotate 400 degree | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -rotx 400 | TG_50_2000_pops_rot400.png | Y | Graph saved to

# Plot results with subject races, window size 600
Plot with window size 600 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -gw 600 | TG_50_2000_pops_gw600.png | Y | Graph saved to

# Plot results with subject races, window size 200
Plot with window size 200 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -gw 200 | TG_50_2000_pops_gw200.png | Y | Graph saved to

# Plot results with subject races, set y-axis limits
Plot with y-axis limits | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ymin 0.9 -ymax 1.7 | TG_50_2000_pops_ymin_0.9.png | Y | Graph saved to

# Plot results with subject races, set x-axis limits
Plot with x-axis limits | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -xmin 1.6 -xmax 1.8 -ymax 1.2 | TG_50_2000_pops_xmin_1.6.png | Y | Graph saved to

# Plot results with subject races, limits with many digits
Plot with multi-digit limits | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -xmin 1.354 -xmax 1.671 -ymax 1.26 -ymax 1.753 | TG_50_2000_pops_xmin_1.354.png | Y | Graph saved to

# Plot results with subject races, too large y-axis range
Plot with large y range | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ymin 0 -ymax 5 | TG_50_2000_pops_large_y_range.png |  | ERROR in parameter settings

# Plot results with subject races, too small y-axis range
Plot with small y range | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ymin 1.22 -ymax 1.23 | TG_50_2000_pops_small_y_range.png |  | ERROR in parameter settings

# Plot results with subject races, too large x-axis range
Plot with large x range | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -xmin 0 -xmax 5 | TG_50_2000_pops_large_x_range.png |  | ERROR in parameter settings

# Plot results with subject races, too small x-axis range
Plot with small x range | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -xmin 1.45 -xmax 1.5 | TG_50_2000_pops_small_x_range.png |  | ERROR in parameter settings

# Plot results with subject races, minsnp set
Plot with min snps | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -minsnp 1835 | TG_50_2000_pops_minsnp.png | Y | Graph saved to

# Plot results with subject races, maxsnp set
Plot with max snps | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -maxsnp 1834 | TG_50_2000_pops_maxsnp.png | Y | Graph saved to

# Plot results with subject races, invalid snp counts
Plot with invalid snps | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -minsnp 50000 | TG_50_2000_pops_invlid_snp.png |  | ERROR: No samples with genotype ancestry SNPs

# Plot results with subject races, selected self-reported populations
Plot with selected races 1,2,3 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -pops 1,2,3 | TG_50_2000_pops_race1_2_3.png | Y | Graph saved to

# Plot results with subject races, selected self-reported populations
Plot with selected races 5,2 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -pops 5,2 | TG_50_2000_pops_race5_2.png | Y | Graph saved to

# Plot results with subject races, invalid races
Plot with selected races 0,8 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -pops 0,d,3,8 | TG_50_2000_pops_inv_races.png | Y | Graph saved to

# Plot results with subject races, selected races, gd4
Plot with selected races + GD4 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -pops 4,1,2 -gd4 | TG_50_2000_pops_races_gd4.png | Y | Graph saved to

# Plot results with subject races, selected races, rotation
Plot with selected races + rotx | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -pops 4,1,2 -rotx 90 | TG_50_2000_pops_races_rotx.png | Y | Graph saved to

# Plot results with invalid input GrafPop result file
Plot with invalid pop file | PlotGrafPopResults.pl | TG_invalid_pop_res.txt | TGP_SbjSuperPop.txt | | TG_invlid_pop_file.png | | ERROR: Invalid input file

# Plot results with invalid subject race file
Plot with invalid race file | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TG_invalid_race.txt| | TG_invalid_race.png | Y | WARNING: No subject races found in

# Plot results with no subject match in subject race file
Plot with no match race file | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TG_nomatch_race.txt| | TG_nomatch_race.png | Y | WARNING: No race values found in

# Plot results with subject races, set parameter for EFA
Plot with EFA cutlines | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ecut 85 -fcut 90 -acut 90 | TG_50_2000_pops_efa_cut.png | Y | Graph saved to

# Plot results with subject races, set parameter for hispanics
Plot with OH cutlines | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ohcut 10 -fhcut 60 | TG_50_2000_pops_oh_cut.png | Y | Graph saved to

# Plot results with subject races, invalid ecut + ohcut
Plot with invalid ecut | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ecut 80 -fcut 90 -ohcut 10 | TG_50_2000_pops_efa_err+ecut.png |  | ERROR in parameter settings

# Plot results with subject races, invalid fcut
Plot with invalid fcut | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -fcut 99 | TG_50_2000_pops_efa_err+fcut.png |  | ERROR in parameter settings

# Plot results with subject races, invalid acut
Plot with invalid acut | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -acut 99 | TG_50_2000_pops_efa_err+acut.png |  | ERROR in parameter settings

# Plot results with subject races, invalid fhcut
Plot with invalid fhcut | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -fhcut 90 | TG_50_2000_pops_efa_err+fhcut.png |  | ERROR in parameter settings

# Plot results with subject races, invalid ohcut
Plot with invalid ohcut | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ohcut 60 | TG_50_2000_pops_efa_err+ohcut.png |  | ERROR in parameter settings


############### The following test cases test Perl script SaveSamples.pl

# Save samples with default settings
Save samples with default parameters | SaveSamples.pl | TG_50_2000_pops.txt | | | TG_50_2000_smps.txt | Y | were selected and saved

# Save samples with self-reported races
Save samples with races | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt| | TG_50_2000_smps_race.txt | Y | were selected and saved

# Save samples with population cutlines
Save samples with cutlines set | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt| -ecut 97 -acut 98 | TG_50_2000_smps_pop_cut.txt | Y | were selected and saved

# Save samples with xcmin set
Save samples with xcmin | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt| -xcmin 1.65 | TG_50_2000_smps_xcmin1.65.txt | Y | were selected and saved

# Save samples within a rectangle area set
Save samples within rect area  | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -xcmin 1.45 -xcmax 1.65 -ycmin 1.25 -ycmax 1.38 | TG_50_2000_smps_rect.txt | Y | were selected and saved

# Save samples outside a rectangle area set
Save samples outside rect area  | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -xcmin 1.45 -xcmax 1.65 -ycmin 1.25 -ycmax 1.38 -isByd | TG_50_2000_smps_rect_byd.txt | Y | were selected and saved

# Save samples with min snps
Save samples with min snps | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -minsnp 1834 | TG_50_2000_smps_minsnp.txt | Y | were selected and saved

# Save samples with max snps
Save samples with max snps | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -maxsnp 1835 | TG_50_2000_smps_minsnp.txt | Y | were selected and saved

# Save samples with invalid input GrafPop result file
Save samples with invalid pop file | SaveSamples.pl | TG_invalid_pop_res.txt | TGP_SbjSuperPop.txt | | TG_invalid_pop_file.txt | | ERROR: Invalid input file

# Save samples with empty input GrafPop result file
Save samples with empty pop file | SaveSamples.pl | TG_empty_pops.txt | TGP_SbjSuperPop.txt | | TG_empty_pop_file.txt | | ERROR: No sample found

# Save samples with large min snps
Save samples with large min snps | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -minsnp 60000 | TG_50_2000_smps_big_snps.txt | | ERROR: No samples with genotype


############### The following test cases test Perl script ExtractAncSnpsFromVcfGz.pl

# Extract ancestry SNP genos from one vcf file
Extract genos from one vcf | ExtractAncSnpsFromVcfGz.pl | TG_2smps_chr9.vcf | | | TG_smps_chr9_anc.vcf | Y | Results saved to

# Extract ancestry SNP genos from one vcf.gz file
Extract genos from one vcf.gz | ExtractAncSnpsFromVcfGz.pl | TG_2_zip_chr16.vcf.gz | | | TG_smps_chr16_anc.vcf | Y | Results saved to

# Extract ancestry SNP genos from multiple vcf files
Extract genos from multi vcf | ExtractAncSnpsFromVcfGz.pl | TG_2smps_chr9.vcf | | chr | TG_smps_chr9_cmb.vcf | Y | Results saved to

# Extract ancestry SNP genos from multiple vcf.gz files
Extract genos from multi vcf.gz | ExtractAncSnpsFromVcfGz.pl | TG_2_zip_chr17.vcf.gz | | chr | TG_smps_chr17_cmb.vcf | Y | Results saved to

# Extract ancestry SNP genos with wrong keyword
Extract genos with wrong keyword | ExtractAncSnpsFromVcfGz.pl | TG_2_zip_chr17.vcf.gz | | smps | TG_smps_wrongkey_anc.vcf |  | ERROR: didn't find keyword



